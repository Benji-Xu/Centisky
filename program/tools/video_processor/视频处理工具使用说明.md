# 视频处理工具使用说明

---

## 功能概览

- 批量管理和处理多个视频文件。
- 支持的操作：
  - **标题处理**：批量清理文件名中的多余字符，并可导出标题到 Excel。
  - **视频归类**：根据 Excel 表中的规则，将视频移动到对应文件夹。
  - **视频压缩**：按目标大小（KB/MB）自动压缩视频体积。
  - **视频分组打包**：按总大小拆分成多个压缩包，适合平台分批上传。
  - **格式转换**：在 MP4 / AVI / MOV / MKV 等格式之间转换。
  - **调整尺寸**：一键调整到 720p / 1080p，或只导出视频封面。

> 以上大部分功能依赖 FFmpeg，请确保已正确配置或在打包版本中集成。

---

## 界面结构

- 顶部标题栏：
  - 左侧 `< 返回首页`：关闭当前工具，回到 Workit 启动器。
  - 中间标题：`视频处理工具`。
  - 右上角 `?`：打开本使用说明。
  - 右上角圆形按钮：切换深色 / 浅色主题。

- 主内容为左右两列：

### 左侧：操作与参数

1. **添加视频文件** 卡片：
   - `添加视频`：选择一个或多个视频文件加入列表。
   - `添加文件夹`：扫描整个文件夹（含子目录），批量导入所有视频。
   - `清空列表`：清除当前已添加的视频。
   - 标题行右上角 `⚙`：设置输出目录（默认使用最后一次选择的视频/文件夹所在目录）。

2. **处理选项** 卡片：
   - 处理类型：
     - `标题处理`
     - `视频归类`
     - `视频压缩`
     - `视频分组`
     - `格式转换`
     - `调整尺寸`
   - 根据不同类型自动显示对应的参数行：

   **格式转换：**
   - 输出格式：MP4 / AVI / MOV / MKV。

   **视频压缩：**
   - 目标大小：数值 + 单位（KB / MB）。

   **调整尺寸：**
   - 尺寸预设：
     - `720p (1280x720)`
     - `1080p (1920x1080)`
     - `仅导出封面`
   - 附加操作：
     - 勾选“同时提取视频封面”，并选择封面格式（JPG / PNG）。

   **标题处理：**
   - 删除字符：输入需要从文件名中删除的关键词（多个用逗号分隔）。
   - 勾选“导出标题到 Excel”时，会生成一个 Excel 文件，保存处理后的标题信息。

   **视频归类：**
   - 选择 Excel 文件，Excel 中包含用于匹配的视频文件名和目标目录信息。

   **视频分组打包：**
   - Excel 模板：定义视频与分组信息的映射。
   - 分组大小：每组压缩包的最大体积（MB）。
   - 匹配列：Excel 中对应视频文件名的列名。

   - 底部 `开始处理` 按钮：按照当前选择的模式和参数执行批量处理。
   - 下方进度条：展示整体处理进度和状态。

### 右侧：视频列表

- 列出所有已添加的视频文件名，可多选 / 滚动查看。
- 会根据当前主题切换背景颜色和选中高亮色。

---

## 基本使用流程

### 1. 批量清理视频标题并导出 Excel

1. 点击“添加视频”或“添加文件夹”导入所有待处理视频。
2. 处理类型选择 `标题处理`。
3. 在“删除字符”中输入需要去除的片段，例如：
   - `混剪,hunjian, ,`
4. 勾选“导出标题到 Excel”。
5. 点击“开始处理”，工具会：
   - 根据规则生成新的文件名（通常只在内部 Excel 中使用，不直接重命名源文件）。
   - 输出一个 Excel 文件，供后续上传平台或人工校对。

### 2. 按 Excel 规则归类视频

1. 准备好一份 Excel，包含视频文件名和目标目录列。
2. 在工具中添加所有视频。
3. 处理类型选择 `视频归类`。
4. 在“Excel 文件”一行中选择对应 Excel 文件。
5. 点击“开始处理”，程序会按 Excel 规则把视频移动/复制到对应目录（以工具内部实现为准）。

### 3. 按目标大小压缩视频

1. 添加需要压缩的视频。
2. 处理类型选择 `视频压缩`。
3. 设置目标大小和单位，例如 `40 MB`。
4. 点击“开始处理”，工具会逐个视频调用 FFmpeg 进行压缩，直到产出文件不超过目标大小（可能略有误差）。

### 4. 批量格式转换

1. 添加需要转换格式的视频。
2. 处理类型选择 `格式转换`。
3. 选择输出格式（如 MP4）。
4. 点击“开始处理”。

### 5. 调整分辨率并导出封面

1. 添加视频。
2. 处理类型选择 `调整尺寸`。
3. 尺寸预设选择 `720p` 或 `1080p`。
4. 若只想要封面，可选择“仅导出封面”。
5. 如需同时提取封面，在“附加操作”中勾选“同时提取视频封面”，并选择封面格式。
6. 点击“开始处理”。

---

## 注意事项

- **FFmpeg 依赖**：
  - 若未检测到 FFmpeg，工具会在顶部下方显示黄色警告，相关功能不可用。
  - 打包版本中建议自带 ffmpeg/ffprobe，可避免环境问题。

- **性能与耗时**：
  - 视频压缩、转换和调整尺寸是重型操作，耗时与原视频时长、分辨率和机器性能有关。
  - 处理过程中请尽量避免频繁最小化 / 强行关闭窗口，以防中断。

- **磁盘空间**：
  - 大批量视频操作前，请确保目标盘有足够剩余空间，否则可能中途失败。

- **Excel 归类 / 分组**：
  - 请保证 Excel 中视频文件名与实际文件名匹配（含扩展名或按工具内部约定）。
  - 若某些视频在 Excel 中找不到匹配规则，工具可能会在日志中给出提示。

- **安全性**：
  - 部分操作可能涉及移动 / 覆盖文件，请确认输出目录与文件名设置是否正确，避免误覆盖重要素材。
