# 螺旋桨管理功能使用说明

## 功能概述

新增的螺旋桨管理功能让你可以直接在标签箱唛工具中管理螺旋桨商品编码与PLD文件的映射关系，支持导入PLD文件和批量添加映射。

## 主要功能

### 1. 快速添加映射（主界面）
在标签箱唛工具的主界面中，你可以看到"螺旋桨映射管理"区域：

**操作步骤：**
1. 在"商品编码"输入框中输入商品编号（如：100181107889）
2. 点击"选择PLD文件"按钮，选择对应的螺旋桨PLD文件
3. 点击"添加映射"按钮完成添加
4. 系统会自动将PLD文件复制到模板目录并保存映射关系

**功能按钮：**
- **导入标签**：直接导入PLD文件到模板目录
- **自动扫描PLD**：扫描并批量添加未映射的螺旋桨文件
- **查看映射**：查看所有现有的螺旋桨映射

### 2. 导入标签功能
点击"导入标签"按钮可以直接将PLD文件导入到模板目录：

#### 功能特性：
- **批量导入**：支持一次选择多个PLD文件进行导入
- **覆盖确认**：如果文件已存在，会询问是否覆盖
- **自动扫描**：导入完成后可选择立即扫描并添加映射
- **目录选择**：如果找不到默认模板目录，可手动选择目标目录

#### 操作说明：
1. 点击"导入标签"按钮
2. 选择要导入的PLD文件（支持多选）
3. 系统自动复制文件到模板目录
4. 选择是否立即扫描并添加映射

### 3. 智能扫描与批量映射
点击"自动扫描PLD"按钮可以智能扫描并批量添加映射：

#### 功能特性：
- **智能识别**：自动识别包含"螺旋桨"关键词的PLD文件
- **批量输入**：为所有未映射文件提供统一的输入界面
- **选择性添加**：可以只为需要的文件输入商品编码，留空的文件不会添加映射
- **实时保存**：输入完成后立即保存到配置文件

#### 操作说明：
1. 点击"自动扫描PLD"按钮
2. 系统扫描模板目录中的螺旋桨文件
3. 在弹出的窗口中为每个未映射文件输入对应的商品编码
4. 点击"保存映射"完成批量添加（留空的文件将被跳过）

### 4. 查看映射功能
点击"查看映射"按钮可以查看所有现有映射：

#### 功能特性：
- **完整列表**：显示所有商品编码与PLD文件的映射关系
- **排序显示**：按商品编码排序显示，便于查找
- **统计信息**：显示当前映射总数
- **只读模式**：防止意外修改，专注于查看

## 支持的文件格式

系统会自动识别包含以下关键词的PLD文件：
- 螺旋桨
- propeller  
- 螺桨
- 螺旋奖
- 螺施桨

## 文件存储位置

- **配置文件**：`propeller_mappings.json`（保存在工具目录下）
- **PLD文件**：自动复制到相应的模板目录

## 使用场景

### 场景1：新增螺旋桨产品
当有新的螺旋桨产品时：
1. 点击"导入标签"将新的PLD文件导入到模板目录
2. 选择立即扫描并添加映射
3. 在弹出的窗口中为新文件输入对应的商品编码
4. 保存映射完成添加

### 场景2：批量导入多个PLD文件
当需要一次性导入多个螺旋桨文件时：
1. 点击"导入标签"按钮
2. 选择多个PLD文件进行批量导入
3. 选择立即扫描并添加映射
4. 为每个文件输入对应的商品编码

### 场景3：检查和补充映射
当需要检查是否有未映射的螺旋桨文件时：
1. 点击"自动扫描PLD"功能
2. 系统会显示所有未映射的螺旋桨文件
3. 为需要的文件输入商品编码
4. 保存映射完成补充

### 场景4：查看现有映射
当需要查看或确认现有映射时：
1. 点击"查看映射"按钮
2. 查看完整的映射列表
3. 确认商品编码与PLD文件的对应关系

## 智能匹配说明

即使没有明确的映射，系统也会尝试智能匹配：

1. **商品编码直接匹配**：如果PLD文件名包含商品编码
2. **店铺前缀匹配**：根据配货表工作表名称匹配对应店铺的螺旋桨文件
3. **模糊匹配**：查找包含商品编码的螺旋桨文件
4. **通用匹配**：按店铺优先级选择螺旋桨文件

## 故障排除

### 问题1：无法添加映射
**可能原因：**
- 商品编码为空
- 未选择PLD文件
- 文件权限问题

**解决方法：**
- 确保输入完整的商品编码
- 选择有效的PLD文件
- 检查文件和目录权限

### 问题2：映射不生效
**可能原因：**
- 配置文件未保存
- PLD文件未正确复制到模板目录

**解决方法：**
- 点击"保存配置"按钮
- 检查模板目录中是否存在PLD文件
- 重启软件重新加载配置

### 问题3：自动扫描无结果
**可能原因：**
- 选择的目录不正确
- PLD文件命名不符合识别规则

**解决方法：**
- 确保选择正确的模板目录
- 检查PLD文件名是否包含"螺旋桨"等关键词
- 手动添加特殊命名的文件

## 注意事项

1. **备份重要数据**：在大量修改映射前，建议备份现有配置
2. **文件命名规范**：建议PLD文件名包含"螺旋桨"关键词以便自动识别
3. **权限要求**：确保软件对模板目录有读写权限
4. **配置同步**：修改映射后记得保存配置以确保更改生效

## 技术支持

如果在使用过程中遇到问题：
1. 查看软件日志中的错误信息
2. 检查配置文件是否正确生成
3. 确认PLD文件是否正确复制到模板目录
4. 重启软件重新加载配置

通过这个新功能，你可以轻松管理螺旋桨映射，无需手动编辑配置文件，大大提高了工作效率！
